# Домашнее задание №1

## Настройка окружения (установка gitlab)
1. Установка Virtualbox (виртуальные машины)
[офф сайт](https://www.virtualbox.org/wiki/Downloads)

скачайте и установите подходящий для вашей платформы дистрибутив

2. Установка Vagrant
[офф сайт](https://www.vagrantup.com)

скачайте и установите подходящий для вашей платформы дистрибутив

3. Поднятие виртуальной машины с centos7.

Создайте директорию для работы, в ней создайте файл с именем Vagrantfile со следующим содержимым:

```
Vagrant.configure("2") do |config|
  config.vm.box = "centos/7"
  config.vm.network "forwarded_port", guest: 80, host: 80
  config.vm.provider "virtualbox" do |v|
    v.memory = 4096
    v.cpus = 2
  end
end
```

4.  После этого в этой директории выполните

```
vagrant up
```

Vagrant скачает образ и запустит виртуальную машину.

Выключить машину можно следующей командой:
```
vagrant halt
```

5. Залогиньтесь на машину

```
vagrant ssh
```

6. Установите в виртуальную машину gitlab

Воспользуйтесь официальной инструкцией
[ссылка на инструкцию](https://about.gitlab.com/install/#centos-7)

В переменную EXTERNAL_URL впишите адрес 'http://gitlab.mephi'

7. Пропишите адрес gitlab.mephi для локальной машины

в linux/os x в файл /etc/hosts
в windows в файл c:\windows\system32\drivers\etc\host
```
127.0.0.1   gitlab.mephi
```

8. Откройте гитлаб и настройте пароль root

[ссылка на локальный гитлаб](http://gitlab.mephi)

9. Создайте группу devops-mephi и в ней проект banners

10. Откройте в другом браузере/режиме инкогнито и зарегистрируйтесь под пользователем, под которым планируете дальнейшую работу (под root работать нехорошо =)

11. Под пользователем root выдайте права Owner на группу devops-mephi для своего пользователя.

12. Склонируйте на локальную машину репозиторий через http

```
git clone http://gitlab.mephi/devops-mephi/banners.git
```
Если по каким-то причинам вы не можете/не хотите устанавливать git на локальную машину, можете делать это в виртуалке

## Создание pre-receive хука для проверки именования коммитов

1. Создайте pre-recieve hook на сервере гитлаба, который будет делать следующее:
проверять, что коммит-сообщения содержат в начале имя ветки, то есть выглядят следующим образом:
```
BAN-00001: описание сделанного
```
Где первые три символа — имя проекта (любые буквы), за ним следует номер задачи, состоящий из любого количества цифр, затем двоеточие
Если коммит назван неверно, нужно отклонить его с понятным разработчику комментарием.

[инструкция gitlab куда положить хук](https://docs.gitlab.com/ee/administration/custom_hooks.html)

Как написать сам хук, нужно выяснить самостоятельно
